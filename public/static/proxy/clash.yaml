mode: rule

sniffer:
  enable: true
  override-destination: true
  force-dns-mapping: true
  parse-pure-ip: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]

proxy-providers:
  provider1:
    type: http
    url: "https://config.lzyxiaobai.top/proxy-configs/verify/lzy114514xiao1919810bai/clash-proxies.yaml"
    proxy: DIRECT
    size-limit: 0
    interval: 3600

proxy-groups:
  - name: "代理节点"
    type: select
    url: "https://cp.cloudflare.com/generate_204"
    disable-udp: false
    include-all-proxies: true
    proxies:
      - "直连"
      - "拒绝"
      - "丢弃"
    use:
      - provider1

  - name: "广告域名"
    type: select
    url: "https://cp.cloudflare.com/generate_204"
    proxies:
      - "代理节点"
      - "直连"
      - "拒绝"
      - "丢弃"

  - name: "游戏"
    type: select
    url: "https://cp.cloudflare.com/generate_204"
    include-all-proxies: true
    proxies:
      - "代理节点"
    use:
      - provider1

  - name: "AI平台"
    type: select
    url: "https://cp.cloudflare.com/generate_204"
    include-all-proxies: true
    proxies:
      - "代理节点"
    use:
      - provider1

  - name: "流媒体"
    type: select
    url: "https://cp.cloudflare.com/generate_204"
    include-all-proxies: true
    proxies:
      - "代理节点"
    use:
      - provider1

  - name: "bilibili"
    type: select
    url: "https://cp.cloudflare.com/generate_204"
    proxies:
      - "直连"
      - "流媒体"

  - name: "Steam"
    type: select
    url: "https://cp.cloudflare.com/generate_204"
    disable-udp: false
    proxies:
      - "代理节点"
      - "直连"

  - name: "Epic"
    type: select
    url: "https://cp.cloudflare.com/generate_204"
    disable-udp: false
    proxies:
      - "代理节点"
      - "直连"

  - name: "cloudflare"
    type: select
    url: "https://cp.cloudflare.com/generate_204"
    proxies:
      - "代理节点"
      - "直连"

  - name: "lzyxiaobai"
    type: select
    url: "https://cp.cloudflare.com/generate_204"
    disable-udp: false
    proxies:
      - "代理节点"
      - "直连"

  - name: "直连"
    type: select
    url: "https://cp.cloudflare.com/generate_204"
    hidden: true
    disable-udp: false
    proxies:
      - DIRECT

  - name: "拒绝"
    type: select
    url: "https://cp.cloudflare.com/generate_204"
    hidden: true
    proxies:
      - REJECT

  - name: "丢弃"
    type: select
    url: "https://cp.cloudflare.com/generate_204"
    hidden: true
    proxies:
      - REJECT-DROP

rules:
  - GEOSITE,private,DIRECT
  - GEOIP,PRIVATE,DIRECT
  - GEOSITE,CN,DIRECT
  - GEOIP,CN,DIRECT
  - DOMAIN,learn.microsoft.com,DIRECT
  - DOMAIN,docs.microsoft.com,DIRECT
  - DOMAIN-SUFFIX,nextdns.io,代理节点
  - DOMAIN-SUFFIX,adguard-dns.io,代理节点
  - DOMAIN-SUFFIX,star-engine.com,游戏
  - GEOSITE,bluearchive,游戏
  - GEOSITE,garena,游戏
  - GEOSITE,escapefromtarkov,游戏
  - GEOSITE,nikke,游戏
  - GEOSITE,projectsekai,游戏
  - GEOSITE,lowiro,游戏
  - GEOSITE,cygames,游戏
  - GEOSITE,rockstar,游戏
  - GEOSITE,ubisoft,游戏
  - GEOSITE,nexon,游戏
  - PROCESS-NAME,pso2.exe,游戏
  - PROCESS-NAME,CozyIsland.exe,DIRECT
  - DOMAIN,lzyxiaobai.top,lzyxiaobai
  - DOMAIN-SUFFIX,lzyxiaobai.top,lzyxiaobai
  - GEOSITE,category-ads-all,广告域名
  - GEOSITE,category-ai-!cn,AI平台
  - GEOSITE,spotify,流媒体
  - GEOSITE,netflix,流媒体
  - GEOSITE,hulu,流媒体
  - GEOSITE,niconico,流媒体
  - GEOSITE,hbo,流媒体
  - GEOSITE,twitch,流媒体
  - DOMAIN-SUFFIX,applemusic.berlin,流媒体
  - DOMAIN-SUFFIX,applemusic.co,流媒体
  - DOMAIN-SUFFIX,applemusic.com,流媒体
  - DOMAIN-SUFFIX,applemusic.com.au,流媒体
  - DOMAIN-SUFFIX,applemusic.hamburg,流媒体
  - DOMAIN-SUFFIX,applemusic.wang,流媒体
  - DOMAIN-SUFFIX,wwwapplemusic.com,流媒体
  - DOMAIN-SUFFIX,musickit.net,流媒体
  - DOMAIN-SUFFIX,applemusicfestival.com,流媒体
  - GEOSITE,bilibili,bilibili
  - GEOSITE,CN,DIRECT
  - GEOIP,CN,DIRECT
  - DOMAIN-SUFFIX,cm.steampowered.com,DIRECT
  - DOMAIN-SUFFIX,steamcontent.com,DIRECT
  - DOMAIN-SUFFIX,steamusercontent.com,DIRECT
  - DOMAIN-SUFFIX,steamchina.com,DIRECT
  - DOMAIN,csgo.wmsj.cn,DIRECT
  - DOMAIN,dota2.wmsj.cn,DIRECT
  - DOMAIN,wmsjsteam.com,DIRECT
  - DOMAIN,dl.steam.clngaa.com,DIRECT
  - DOMAIN,dl.steam.ksyna.com,DIRECT
  - DOMAIN,st.dl.bscstorage.net,DIRECT
  - DOMAIN,st.dl.eccdnx.com,DIRECT
  - DOMAIN,st.dl.pinyuncloud.com,DIRECT
  - DOMAIN,xz.pphimalayanrt.com,DIRECT
  - DOMAIN,steampipe.steamcontent.tnkjmec.com,DIRECT
  - DOMAIN,steampowered.com.8686c.com,DIRECT
  - DOMAIN,steamstatic.com.8686c.com,DIRECT
  - DOMAIN,steambroadcast.akamaized.net,Steam
  - DOMAIN,steamcdn-a.akamaihd.net,Steam
  - DOMAIN,steamcommunity-a.akamaihd.net,Steam
  - DOMAIN,steampipe.akamaized.net,Steam
  - DOMAIN,steamstore-a.akamaihd.net,Steam
  - DOMAIN,steamusercontent-a.akamaihd.net,Steam
  - DOMAIN,steamuserimages-a.akamaihd.net,Steam
  - DOMAIN-SUFFIX,fanatical.com,Steam
  - DOMAIN-SUFFIX,humblebundle.com,Steam
  - DOMAIN-SUFFIX,playartifact.com,Steam
  - DOMAIN-SUFFIX,steam-chat.com,Steam
  - DOMAIN-SUFFIX,steamcommunity.com,Steam
  - DOMAIN-SUFFIX,steamgames.com,Steam
  - DOMAIN-SUFFIX,steampowered.com,Steam
  - DOMAIN-SUFFIX,steamstat.us,Steam
  - DOMAIN-SUFFIX,steamstatic.com,Steam
  - DOMAIN-SUFFIX,underlords.com,Steam
  - DOMAIN-SUFFIX,valvesoftware.com,Steam
  - DOMAIN-SUFFIX,steamusercontent.com,Steam
  - GEOSITE,steam,Steam
  - GEOSITE,epicgames,Epic
  - DOMAIN-SUFFIX,cloudflare.com,cloudflare
  - GEOSITE,cloudflare,cloudflare
  - MATCH,代理节点

dns:
  default-nameserver:
  - quic://223.5.5.5
  - tls://223.5.5.5
  - https://223.5.5.5/dns-query
  - system
  direct-nameserver:
  - quic://223.5.5.5
  - tls://223.5.5.5
  - https://223.5.5.5/dns-query
  - system
  direct-nameserver-follow-policy: false
  enable: true
  enhanced-mode: fake-ip
  fake-ip-filter:
  - '*.lan'
  - '*.local'
  - '*.arpa'
  - time.*.com
  - ntp.*.com
  - time.*.com
  - +.market.xiaomi.com
  - localhost.ptlogin2.qq.com
  - '*.msftncsi.com'
  - www.msftconnecttest.com
  fake-ip-filter-mode: blacklist
  fake-ip-range: 198.18.0.1/16
  fallback: []
  fallback-filter:
    domain:
    - +.google.com
    - +.facebook.com
    - +.youtube.com
    geoip: true
    geoip-code: CN
    ipcidr:
    - 240.0.0.0/4
    - 0.0.0.0/32
  ipv6: true
  listen: :53
  nameserver:
  - tls://45.90.28.0
  - quic://223.5.5.5
  - tls://223.5.5.5
  - https://223.5.5.5/dns-query
  prefer-h3: false
  proxy-server-nameserver:
  - quic://223.5.5.5
  - tls://223.5.5.5
  - https://223.5.5.5/dns-query
  respect-rules: false
  use-hosts: false
  use-system-hosts: true
